---
import Docker from "../icons/Docker.astro";
import Python from "../icons/Python.astro";
import C from "../icons/c.astro";
import CSharp from "../icons/csharp.astro";
import Django from "../icons/Django.astro";
import Azure from "../icons/Azure.astro";
import GoogleCloud from "../icons/GoogleCloud.astro";
import Redis from "../icons/Redis.astro";
import Vue from "../icons/Vue.astro";
import Unity from "../icons/Unity.astro";
import ProjectItem from "./ProjectItem.astro";
import projectsEs from "../i18n/es/projects.json";
import projectsEn from "../i18n/en/projects.json";

type Lang = "es" | "en";
const { lang = "es" } = Astro.props as { lang?: Lang };
const projectsData = lang === "en" ? projectsEn : projectsEs;

const TECH = {
    C: { name: "C", class: "bg-[#00599C] text-white", icon: C },
    CSHARP: { name: "C#", class: "bg-[#239120] text-white", icon: CSharp },
    PYTHON: { name: "Python", class: "bg-[#3776AB] text-white", icon: Python },
    DJANGO: { name: "Django", class: "bg-black text-white", icon: Django },
    DOCKER: { name: "Docker", class: "bg-[#003159] text-white", icon: Docker },
    AZURE: { name: "Azure", class: "bg-[#0089D6] text-white", icon: Azure },
    REDIS: { name: "Redis", class: "bg-[#DC382D] text-white", icon: Redis },
    GOOGLECLOUD: { name: "Google Cloud", class: "bg-[#DC382D] text-white", icon: GoogleCloud },
    UNITY: { name: "Unity", class: "bg-black text-white", icon: Unity },
    VUE: { name: "Vue.js", class: "bg-[#42b883] text-white", icon: Vue },
    SQL: { name: "SQL", class: "bg-[#003B57] text-white", icon: C },
};

const TECH_BY_ID: Record<number, typeof TECH[keyof typeof TECH][]> = {
    0: [TECH.C],
    1: [TECH.PYTHON, TECH.DJANGO, TECH.DOCKER, TECH.VUE],
    2: [TECH.PYTHON, TECH.GOOGLECLOUD],
    3: [TECH.PYTHON, TECH.DJANGO, TECH.DOCKER, TECH.REDIS, TECH.AZURE],
    4: [TECH.CSHARP, TECH.UNITY],
};

const PROJECTS = projectsData.items
    .map((p) => ({
        ...p,
        image: "",
        progress: (p as { progress?: number }).progress ?? 100,
        techs: TECH_BY_ID[p.id] ?? [],
    }))
    .sort((a, b) => b.id - a.id);
---

<div class="flex flex-col gap-y-16 mb-16">
    {PROJECTS.map((project) => (
        <ProjectItem
            id={project.id}
            title={project.title}
            description={project.description}
            link={project.link}
            github={project.github}
            image=""
            progress={project.progress}
            techs={project.techs}
            codeLabel={projectsData.buttons.code}
            previewLabel={projectsData.buttons.preview}
        />
    ))}
</div>
